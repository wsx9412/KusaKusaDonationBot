<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

<script>
    // 1. 본인의 Firebase 설정값으로 교체하세요
    const firebaseConfig = __FIREBASE_CONFIG__; // 빌드 시점에 교체될 자리
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // 2. 메시지 전송 함수 (다른 사람이 사용)
    function sendChat() {
        const input = document.getElementById('chatInput');
        const text = input.value.trim();
        if (text) {
            database.ref('chat').set({
                msg: text,
                timestamp: Date.now()
            });
            input.value = '';
        }
    }

    // 3. 메시지 수신 및 읽기 (OBS 브라우저 소스가 실행)
    database.ref('chat').on('value', (snapshot) => {
        const data = snapshot.val();
        if (data && data.msg) {
            document.getElementById('display').innerText = data.msg;
            speak(data.msg);
        }
    });

    function speak(text) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ko-KR';
        window.speechSynthesis.speak(utterance);
    }
</script>
